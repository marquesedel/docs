---
title: "Modelos de Dados"
description: "Estruturas de dados e modelos do Caki"
---

## Vis√£o Geral

Os modelos definem a estrutura de dados usada em todo o app. Eles s√£o classes Dart simples que representam entidades do dom√≠nio.

## Modelos Principais

### 1. WorkoutData
**Localiza√ß√£o**: `lib/models/workout_data.dart`

Representa dados de um treino/exerc√≠cio.

**Propriedades**:
```dart
class WorkoutData {
  final String distance;           // Ex: "17.1 km"
  final String movingTime;          // Ex: "2:25:10"
  final String elevation;           // Ex: "176 m"
  final String pace;                // Ex: "8:30/km"
  final String calories;           // Ex: "850 kcal"
  final DateTime date;              // Data do treino
  final String activityType;        // Ex: "Running", "Cycling"
  final String? temperature;        // Temperatura (opcional)
  
  // Valores num√©ricos brutos
  final double distanceMeters;
  final double elevationMeters;
  final Duration duration;
}
```

**Construtores**:
- `WorkoutData()` - Construtor padr√£o
- `WorkoutData.mock()` - Dados mockados para testes
- `WorkoutData.fromHealthData()` - A partir de dados do Health Service

**M√©todos √öteis**:
```dart
// Data formatada
String formattedDate = workoutData.formattedDate; // "dd MMM yyyy, HH:mm"

// Emoji da atividade
String emoji = workoutData.activityEmoji; // "üèÉ", "üö¥", etc.
```

**Exemplo de Uso**:
```dart
final workout = WorkoutData.fromHealthData(
  distanceMeters: 17100.0,
  duration: Duration(hours: 2, minutes: 25, seconds: 10),
  elevationMeters: 176.0,
  caloriesKcal: 850.0,
  date: DateTime.now(),
  activityType: 'Running',
  temperature: '22¬∞C',
);
```

### 2. FrameDesign
**Localiza√ß√£o**: `lib/models/frame_design.dart`

Representa um design de frame para exibir dados de treino.

**Propriedades**:
```dart
class FrameDesign {
  final String id;                    // ID √∫nico
  final String name;                  // Nome do design
  final Color backgroundColor;        // Cor de fundo
  final Color textColor;              // Cor do texto
  final FramePosition position;       // Posi√ß√£o (bottom/top/center)
  final FrameStyle style;             // Estilo (minimal/sport/elegant/bold)
  
  // Background pr√©-configurado
  final bool hasPresetBackground;
  final List<Color> presetBackgroundColors;
  final bool presetBackgroundIsGradient;
  
  // Posi√ß√£o customiz√°vel
  final double? customOffsetX;         // Offset horizontal (-1.0 a 1.0)
  final double? customOffsetY;         // Offset vertical (-1.0 a 1.0)
  final bool useCustomPosition;       // Usar posi√ß√£o customizada
  
  // Builder customizado
  final Widget Function(bool isDragging, dynamic workoutData)? customFrameBuilder;
}
```

**Enums**:
```dart
enum FramePosition {
  bottom,
  top,
  center,
}

enum FrameStyle {
  minimal,
  sport,
  elegant,
  bold,
}
```

**Uso**:
```dart
final design = FrameDesign(
  id: 'minimal',
  name: 'Minimal',
  backgroundColor: Colors.black,
  textColor: Colors.white,
  position: FramePosition.bottom,
  style: FrameStyle.minimal,
);
```

### 3. WidgetInstance
**Localiza√ß√£o**: `lib/models/widget_instance.dart`

Representa uma inst√¢ncia de um widget adicionado ao editor.

**Propriedades**:
```dart
class WidgetInstance {
  final String id;                    // ID √∫nico
  final FrameDesign design;           // Design do widget
  Offset position;                    // Posi√ß√£o na tela
  double scale;                        // Escala (1.0 = tamanho normal)
  double rotation;                    // Rota√ß√£o em graus
  bool isDragging;                    // Se est√° sendo arrastado
  bool isDeleting;                    // Se est√° sendo deletado
  Size? renderedSize;                 // Tamanho ap√≥s renderiza√ß√£o
}
```

**M√©todos**:
```dart
// Criar c√≥pia com mudan√ßas
WidgetInstance copyWith({
  Offset? position,
  double? scale,
  double? rotation,
  // ...
})
```

**Uso**:
```dart
final widget = WidgetInstance(
  id: 'widget_1',
  design: frameDesign,
  position: Offset(100, 200),
  scale: 1.0,
  rotation: 0.0,
);

// Atualizar posi√ß√£o
final updated = widget.copyWith(position: Offset(150, 250));
```

### 4. SubscriptionProduct
**Localiza√ß√£o**: `lib/models/subscription_product.dart`

Representa um produto de assinatura.

**Propriedades**:
```dart
class SubscriptionProduct {
  final String id;                    // ID do produto
  final String title;                 // T√≠tulo
  final String description;            // Descri√ß√£o
  final String price;                 // Pre√ßo formatado
  final String period;                // Per√≠odo (mensal/anual/vital√≠cio)
  final Package package;              // Package do RevenueCat
}
```

## Registros e Factories

### WidgetsRegistry
**Localiza√ß√£o**: `lib/widgets/widgets_registry.dart`

Registra todos os widgets dispon√≠veis para adicionar ao editor.

```dart
// Obter todos os widgets
List<FrameDesign> allWidgets = WidgetsRegistry.allWidgets;

// Obter widget por ID
FrameDesign? widget = WidgetsRegistry.getWidgetById('minimal');
```

### FiltersRegistry
**Localiza√ß√£o**: `lib/filters/filters_registry.dart`

Registra todos os filtros dispon√≠veis.

```dart
// Obter todos os filtros
List<ImageFilter> allFilters = FiltersRegistry.allFilters;

// Obter filtro por nome
ImageFilter? filter = FiltersRegistry.getFilterByName('black_white');
```

## Serializa√ß√£o

Atualmente, os modelos n√£o implementam serializa√ß√£o JSON. Se necess√°rio no futuro, considere usar:
- `json_serializable` para gera√ß√£o autom√°tica
- `json_annotation` para anota√ß√µes

## Boas Pr√°ticas

1. **Imutabilidade**: Prefira propriedades `final` quando poss√≠vel
2. **Construtores Factory**: Use para criar inst√¢ncias de diferentes fontes
3. **M√©todos Helper**: Adicione m√©todos √∫teis como `formattedDate`, `activityEmoji`
4. **Valida√ß√£o**: Valide dados nos construtores quando apropriado
5. **Documenta√ß√£o**: Documente propriedades e m√©todos complexos

